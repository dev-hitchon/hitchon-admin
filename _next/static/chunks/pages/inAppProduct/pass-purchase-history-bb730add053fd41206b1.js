(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[562],{8265:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(5893),a=n(6156),o=n(6829),u=n(8610),c=n(9552),s=n(5925),i=n(7294),l=n(3461);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){var t=(0,o.useQuery)(e.query,{variables:e.variables}),n=t.data,f=t.loading,h=(t.error,t.networkStatus,t.called,(0,i.useState)(!1)),p=h[0],v=h[1],b=(0,s.Z)(),y=(b.showMessage,b.Snack);(0,i.useEffect)((function(){v(!(f||!n))}),[n,f]);return{DownloadButton:function(t){var o;return(0,r.jsxs)(u.Z,{variant:"contained",disabled:!p,children:[p?(0,r.jsx)(l.CSVLink,{headers:e.headers,data:(null===n||void 0===n||null===(o=n[e.dataKey])||void 0===o?void 0:o.map((function(t){return e.headers.reduce((function(e,n,r){var o=n.format(t);return e[n.key]=o,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e)}),{})})))||"",filename:"".concat((new Date).toLocaleString(),".csv"),target:"_blank",children:t.label}):(0,r.jsx)(c.Z,{}),(0,r.jsx)(y,{})]})}}}},1554:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(5893),a=n(7757),o=n.n(a),u=n(6156),c=n(2137),s=n(6112),i=n(5022),l=n(3769),d=n(7294),f=n(4699),h=n(6829),p=n(2465),v=n(3121);function b(){var e=(0,p.Z)(["\n    query Admin_passPurchases($where: PassPurchaseWhereInput, $orderBy: [PassPurchaseOrderByInput], $skip: Int, $take: Int) {\n        admin_passPurchases(where: $where, orderBy: $orderBy, skip: $skip, take: $take) {\n            id\n            user {\n                id\n                phoneNum\n                activeProfile {\n                    id\n                    nickname\n                }\n            }\n            product {\n                id\n                store\n                title\n            }\n            purchasedAt\n            startDate\n            endDate\n            wasDiscounted\n            cost\n            currency\n        }\n    }\n"]);return b=function(){return e},e}var y=(0,v.ZP)(b());function w(){var e=(0,p.Z)(["\n    query PassPurchasesCount($where: PassPurchaseWhereInput) {\n        passPurchasesCount(where: $where)\n    }\n"]);return w=function(){return e},e}var P=(0,v.ZP)(w());var m=n(4433),g=n(6531),j=n(3150),k=n(8265);function O(e){var t=(0,k.Z)({query:y,variables:{where:e.where},dataKey:"admin_passPurchases",headers:[{key:"purchasedAt",label:"\uad6c\ub9e4 \uc77c\uc790",format:function(e){return new Date(e.purchasedAt).toString()}},{key:"user",label:"\uad6c\ub9e4 \ud68c\uc6d0",format:function(e){var t,n,r;return"".concat(null===e||void 0===e||null===(t=e.user)||void 0===t||null===(n=t.activeProfile)||void 0===n?void 0:n.nickname,"(").concat(null===e||void 0===e||null===(r=e.user)||void 0===r?void 0:r.phoneNum,")")}},{key:"product",label:"\uad6c\ub9e4 \uc0c1\ud488",format:function(e){return"".concat(null===e||void 0===e?void 0:e.product.title,"(").concat(null===e||void 0===e?void 0:e.product.store,")")}},{key:"startDate",label:"\ud328\uc2a4 \uc2dc\uc791\uc77c",format:function(e){return new Date(e.startDate).toString()}},{key:"endDate",label:"\ud328\uc2a4 \uc885\ub8cc\uc77c",format:function(e){return new Date(e.endDate).toString()}},{key:"wasDiscounted",label:"\ud560\uc778\uc5ec\ubd80",format:function(e){return e.wasDiscounted?"\ud560\uc778\uc0c1\ud488":"\ubbf8\ud560\uc778\uc0c1\ud488"}},{key:"cost",label:"\uad6c\ub9e4 \ube44\uc6a9",format:function(e){return null===e||void 0===e?void 0:e.cost.toLocaleString()}},{key:"currency",label:"\ud1b5\ud654",format:function(e){return null===e||void 0===e?void 0:e.currency}}]}).DownloadButton;return(0,r.jsx)(t,{label:e.label})}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){var t,n,a,u=(0,g.Z)(),p=function(){var e=(0,h.useLazyQuery)(y),t=(0,f.Z)(e,2);return{fetchPassPurchases:t[0],fetchResult:t[1]}}(),v=p.fetchPassPurchases,b=p.fetchResult,w=function(){var e=(0,h.useLazyQuery)(P,{fetchPolicy:"cache-and-network"}),t=(0,f.Z)(e,2);return{fetchPurchasesCount:t[0],fetchResult:t[1]}}(),k=w.fetchPurchasesCount,D=w.fetchResult,x=(0,d.useState)(0),S=x[0],_=x[1],C=(0,d.useState)(10),N=C[0],E=C[1],$=(0,d.useState)(""),B=$[0],A=$[1],q=function(){var t=(0,c.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:k({variables:{where:Z(Z({},e.where),{},{isGift:{equals:!1},book:B&&B.length>0?{user:{phoneNum:{contains:B}}}:void 0})}});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),I=function(){var t=(0,c.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:v({variables:{where:Z(Z({},e.where),{},{isGift:{equals:!1},book:B&&B.length>0?{user:{phoneNum:{contains:B}}}:void 0}),orderBy:e.orderBy,skip:S*N,take:N}});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,d.useEffect)((function(){I(),q()}),[]),(0,m.Z)({timeout:"200",dependencies:[S,N,B],onTimeout:function(){I(),q()}}),(0,r.jsxs)(s.Z,{children:[(0,r.jsxs)(i.Z,{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(l.Z,{variant:"standard",focused:!0,label:"\ud68c\uc6d0 \ud734\ub300\uc804\ud654 \ubc88\ud638",onChange:function(e){return A(e.target.value)}}),(0,r.jsx)(O,{where:Z(Z({},e.where),{},{isGift:{equals:!1},book:B&&B.length>0?{user:{phoneNum:{contains:B}}}:void 0}),label:"".concat((null===D||void 0===D||null===(t=D.data)||void 0===t?void 0:t.passPurchasesCount)||0,"\uac74 \uc5d1\uc140 \ub2e4\uc6b4\ub85c\ub4dc")})]}),(0,r.jsx)(j.Z,{maxHeight:u.height-170,columns:[{id:"purchasedAt",label:"\uad6c\ub9e4 \uc77c\uc790",minWidth:200,format:function(e){return new Date(e).toString()}},{id:"user",label:"\uad6c\ub9e4 \ud68c\uc6d0",format:function(e){var t;return"".concat(null===e||void 0===e||null===(t=e.activeProfile)||void 0===t?void 0:t.nickname,"(").concat(null===e||void 0===e?void 0:e.phoneNum,")")}},{id:"product",label:"\uad6c\ub9e4 \uc0c1\ud488",format:function(e){return"".concat(e.title,"(").concat(e.store,")")}},{id:"startDate",label:"\ud328\uc2a4 \uc2dc\uc791\uc77c"},{id:"endDate",label:"\ud328\uc2a4 \uc885\ub8cc\uc77c"},{id:"wasDiscounted",label:"\ud560\uc778\uc5ec\ubd80",format:function(e){return e?"\ud560\uc778\uc0c1\ud488":"\ubbf8\ud560\uc778\uc0c1\ud488"}},{id:"cost",label:"\uad6c\ub9e4 \ube44\uc6a9",format:function(e){return e.toLocaleString()}},{id:"currency",label:"\ud1b5\ud654"}],rows:null===(n=b.data)||void 0===n?void 0:n.admin_passPurchases,paginationMod:{totalCount:(null===D||void 0===D||null===(a=D.data)||void 0===a?void 0:a.passPurchasesCount)||0,page:S,rowsPerPage:N,onPageChange:function(e,t){_(t)},onRowsPerPageChange:function(e){E(parseInt(e.target.value,10)),_(0)}}})]})}var S=n(9018),_=n(5925),C=n(5275),N=n(8329);function E(e){var t=(0,_.Z)(),n=(t.showMessage,t.Snack);return(0,r.jsxs)(C.Z,{Navigation:(0,r.jsx)(S.ZP,{title:"\uacb0\uc81c\uad00\ub9ac - \ud328\uc2a4\uc720\ub8cc\uacb0\uc81c\ub0b4\uc5ed",position:"sticky",actionComponent:(0,r.jsx)(S.v2,{})}),children:[(0,r.jsx)(x,{orderBy:[{purchasedAt:N.As.Desc}]}),(0,r.jsx)(n,{})]})}},6535:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/inAppProduct/pass-purchase-history",function(){return n(1554)}])}},function(e){e.O(0,[680,34,123,223,710,735,788,774,888,179],(function(){return t=6535,e(e.s=t);var t}));var t=e.O();_N_E=t}]);